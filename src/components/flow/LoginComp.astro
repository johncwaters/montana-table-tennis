---
---

<!-- FORM TITLE -->
<div class="text-center pt-8">
    <h1 class="text-3xl font-bold">Welcome back</h1>
    <p class="text-base pt-2 pb-4">Please enter your details.</p>
</div>
<!-- LOGIN FORM -->
<section class="flex justify-center">
    <div class="form-control w-screen max-w-xs">
        <label class="label">
            <span class="label-text">Email</span>
        </label>
        <input
            id="email"
            type="text"
            placeholder=""
            class="input input-bordered input-primary w-full max-w-xs"
        />
        <label class="label">
            <span class="label-text">Password</span>
            <span class="label-text-alt"
                ><a class="text-accent-focus" href="/flow/forgot-password"
                    >Forgot Password?</a
                >
            </span>
        </label>
        <input
            id="password"
            type="password"
            placeholder=""
            class="input input-bordered input-primary w-full max-w-xs"
        />

        <label class="label cursor-pointer pt-4 pb-4 w-fit">
            <input
                type="checkbox"
                checked="checked"
                class="checkbox checkbox-primary mr-3"
            />
            <span class="label-text">Remember me</span>
        </label>

        <button id="submit" type="submit" class="btn btn-primary">Submit</button
        >
        <!-- ALT LOGIN OPTIONS -->
        <button class="btn btn-outline gap-2 mt-2 mb-2">
            <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-6 w-6"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                ><path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"
                ></path>
            </svg>
            Google
        </button>
        <button class="btn btn-outline gap-2 mt-2 mb-2">
            <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-6 w-6"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                ><path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"
                ></path>
            </svg>
            Facebook
        </button>
        <button class="btn btn-outline gap-2 mt-2 mb-2">
            <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-6 w-6"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                ><path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"
                ></path>
            </svg>
            Apple
        </button>

        <!-- NO ACCOUNT OPTIONS -->
        <span class="label-text pt-4">
            Don't have an account? <a
                class="text-accent-focus"
                href="/flow/register">Sign up</a
            >
        </span>
    </div>
</section>

<script>
    //ON SUBMIT:
    //Validate correct data was entered, if not, display error and helpers
    //If valid, check if user already exsists
    //If no user exsists, register as new user
    //Redirect to successful sign-up screen to have user confirm email
    //User confirms email and signs in, finally providing a Session key

    import { supabase } from "../auth/publicClient";
    var btn = document.getElementById("submit");
    btn!.addEventListener("click", getFormData);

    async function getFormData() {
        var results = {
            email: (<HTMLInputElement>document.getElementById("email")).value,
            password: (<HTMLInputElement>document.getElementById("password"))
                .value,
        };

        console.log(results);

        await signInWithEmail(results);
    }

    async function signInWithEmail(results: object) {
        const { user, session, error } = await supabase.auth.signIn({
            email: results.email,
            password: results.password,
        });

        console.log(session, error);
    }
</script>
